<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> qwop-gym | Simeon Manolov </title> <meta name="author" content="Simeon Manolov"> <meta name="description" content="An AI for Bennet Foddy's game called " qwop> <meta name="keywords" content="ai-projects, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.css"> <link rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%F0%9F%95%B9%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://smanolloff.github.io/projects/qwop-gym/"> <link rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script src="/assets/js/theme.js?eb1d88d288af1dac35de430dae5a0768"></script> </head> <body class="fixed-top-nav sticky-bottom-footer"> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">SimeonÂ </span> Manolov </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">About </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">Projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">Repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/cv/">CV </a> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="fa-solid fa-moon"></i> <i class="fa-solid fa-sun"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5"> <div class="post"> <header class="post-header"> <h1 class="post-title">qwop-gym</h1> <p class="post-description">An AI for Bennet Foddy's game called "QWOP"</p> </header> <article> <p><a href="https://www.foddy.net/Athletics.html" rel="external nofollow noopener" target="_blank">QWOP</a> is simple browser-based game about running fast down a 100-meter track. The game is really hard to play and you will quickly find yourself unable to make Atlas run without falling. And itâ€™s a perfect task for AI.</p> <div class="row justify-content-md-center"> <div class="col-sm-6"> <figure> <picture> <img src="/assets/img/qwop-gym/qwop-gameplay.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="QWOP" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h3 id="problem-statement">Problem Statement</h3> <p>The game is nearly impossible for a human to play. Few people in this world have ever been able to master it. According to the <a href="https://www.speedrun.com/qwop" rel="external nofollow noopener" target="_blank">QWOP leaderboard</a>, the fastest QWOP runner in the world can reach the finish line in 4.6 in-game seconds (45.53 real-time seconds).</p> <p>Can an AI learn to play this game, and how would it perform compared to the best players in the world?</p> <h3 id="objective">Objective</h3> <p>Train an AI agent that can surpass the QWOP world record.</p> <h3 id="proposed-solution">Proposed Solution</h3> <p>Transform QWOP into a reinforcement learning environment and forge an AI which meets the objective.</p> <p>Using the RL environment, train an AI agent and compare its performance with the results recorded by the worldâ€™s top players.</p> <p>Contribute to the Gymnasium project by submitting the RL environment as an official <a href="https://gymnasium.farama.org/main/environments/third_party_environments/" rel="external nofollow noopener" target="_blank">third-party environment</a>.</p> <h3 id="approach">Approach</h3> <p>This is the section in which I break down the objective, lay out an execution plan for completing the task, describe the implementation details and talk share the challenges I have encountered along the way.</p> <p>Since the project was already completed by the time I decided to create this web page, I will start by posting the results first and will leave this section blank, eventually filling it up with content whenever I find time to.</p> <h4 id="converting-qwop-into-an-rl-environment">Converting QWOP into an RL environment</h4> <p>QWOP is a JavaScript game which relies on WebGL â€“ this means it <em>must</em> run within a web browser and communicate to a Python backend (which handles the training).</p> <div class="row justify-content-md-center"> <div class="col-sm-8"> <figure> <picture> <img src="/assets/img/qwop-gym/communication.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Communication diagram" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <p>For the purpose I had to find out how to send the information from the game (i.e. the browser) to the python process. The obvious approach was some kind of HTTP protocol, so I developed a custom communication protocol for the purpose bu launching a WebSocket server and a web browser as soon as <code class="language-plaintext highlighter-rouge">QwopEnv</code> (as the RL env is named) is started. Both the env and the browser connect to the WebSocket server, which acts as a message proxy between the two clients - a process best described via the sequence diagram below:</p> <div class="row justify-content-md-center"> <div class="col-sm-6"> <figure> <picture> <img src="/assets/img/qwop-gym/bootstrap.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="Bootstrap process" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <h5 id="communication-protocol">Communication protocol</h5> <p>The env&lt;-&gt;browser communication is governed by a protocol I designed specifically for this purpose. It consists of a 1-byte header and variable-length payload, here are some examples:</p> <table> <thead> <tr> <th>Message description</th> <th>byte 1</th> <th>byte 2</th> <th>bytes 3+</th> </tr> </thead> <tbody> <tr> <td>Registration request</td> <td><code class="language-plaintext highlighter-rouge">0</code></td> <td>(id)</td> <td>Â </td> </tr> <tr> <td>Game command: â€œWâ€ key</td> <td><code class="language-plaintext highlighter-rouge">3</code></td> <td><code class="language-plaintext highlighter-rouge">0b00000101</code></td> <td>step (1 byte) + reward (4 bytes) + total_reward (4 bytes)</td> </tr> <tr> <td>Game command: restart game</td> <td><code class="language-plaintext highlighter-rouge">3</code></td> <td><code class="language-plaintext highlighter-rouge">0b00100001</code></td> <td>Â </td> </tr> <tr> <td>Game command: take screenshot</td> <td><code class="language-plaintext highlighter-rouge">3</code></td> <td><code class="language-plaintext highlighter-rouge">0b10000000</code></td> <td>Â </td> </tr> <tr> <td>Game response: observation</td> <td><code class="language-plaintext highlighter-rouge">4</code></td> <td><code class="language-plaintext highlighter-rouge">0b00000000</code></td> <td>time (4 bytes) + distance (4 bytes) + body state (60 bytes)</td> </tr> <tr> <td>Game response: observation (game over)</td> <td><code class="language-plaintext highlighter-rouge">4</code></td> <td><code class="language-plaintext highlighter-rouge">0b00000010</code></td> <td>time (4 bytes) + distance (4 bytes) + body state (60 bytes)</td> </tr> <tr> <td>Game response: screenshot (JPEG)</td> <td><code class="language-plaintext highlighter-rouge">5</code></td> <td><code class="language-plaintext highlighter-rouge">0b00000000</code></td> <td>(image data)</td> </tr> <tr> <td>Game response: screenshot (PNG)</td> <td><code class="language-plaintext highlighter-rouge">5</code></td> <td><code class="language-plaintext highlighter-rouge">0b00000001</code></td> <td>(image data)</td> </tr> <tr> <td>Log</td> <td><code class="language-plaintext highlighter-rouge">6</code></td> <td>(utf-8 text)</td> <td>(utf-8 text - cont.)</td> </tr> <tr> <td>Error</td> <td><code class="language-plaintext highlighter-rouge">7</code></td> <td>(utf-8 text)</td> <td>(utf-8 text - cont.)</td> </tr> <tr> <td>Reload page</td> <td><code class="language-plaintext highlighter-rouge">8</code></td> <td>Â </td> <td>Â </td> </tr> </tbody> </table> <h5 id="ï¸-actions">ğŸ•¹ï¸ Actions</h5> <p>There are 16 discrete actions in the game, corresponding to 0, 1, 2, 3 or 4-key combinations of the below keys:</p> <ul> <li>Q (thighs 1)</li> <li>W (thighs 2)</li> <li>O (calves 1)</li> <li>P (calves 2)</li> </ul> <p>Performing an action is done via the envâ€™s <code class="language-plaintext highlighter-rouge">step</code> method, which expects an integer as input, so each action is mapped to a key (combination) as follows:</p> <p><code class="language-plaintext highlighter-rouge">0</code>=(none), <code class="language-plaintext highlighter-rouge">1</code>=Q, <code class="language-plaintext highlighter-rouge">2</code>=W, <code class="language-plaintext highlighter-rouge">3</code>=O, <code class="language-plaintext highlighter-rouge">4</code>=P, <code class="language-plaintext highlighter-rouge">5</code>=Q+W, <code class="language-plaintext highlighter-rouge">6</code>=Q+O, â€¦, <code class="language-plaintext highlighter-rouge">15</code>=Q+W+O+P</p> <p>Some of the key combinations in the game are redundant: for example, pressing Q+W is equivalent to pressing just Q. Similarly, O+P is the same as O and so on. By default, those are still considered valid actions by QwopEnv and agents (including humans) should learn this peculiarity on their own. For the sake of reducing training times, however, removing redundant actions is made configurable in the form of the <code class="language-plaintext highlighter-rouge">reduced_action_set</code> env parameter, which reduces the total number of actions from 16 to just 9.</p> <p>Optionally, an <em>extra</em> action can be added for the T key in order to immediately terminate the env - useful when playing manually to force a restart (instead of having to wait for the athlete to fall). This behaviour is controlled by the <code class="language-plaintext highlighter-rouge">t_for_terminate</code> env parameter, which increases the total number of actions to 17 (or 10, if <code class="language-plaintext highlighter-rouge">reduced_action_set</code> is also enabled).</p> <h5 id="ï¸-observations">ğŸ‘ï¸ Observations</h5> <p>On each step, the browser sends the following data to the RL env:</p> <ul> <li>game state (termination condition)</li> <li>time elapsed (used in reward calculations)</li> <li>distance ran (used in reward calculations)</li> <li>body state</li> </ul> <p>The body state contains data about the athleteâ€™s 12 body parts:</p> <ul> <li>Torso</li> <li>Head</li> <li>Left Arm</li> <li>Left Calf</li> <li>Left Foot</li> <li>Left Forearm</li> <li>Left Thigh</li> <li>Right Arm</li> <li>Right Calf</li> <li>Right Foot</li> <li>Right Forearm</li> <li>Right Thigh</li> </ul> <p>Each of those body parts is represented by 5 floats:</p> <table> <thead> <tr> <th>#</th> <th>Description</th> <th>Min</th> <th>Max</th> <th>Unit</th> <th>Note</th> </tr> </thead> <tbody> <tr> <td>0</td> <td>position (x-axis)</td> <td>-10</td> <td>1050</td> <td>decimeters</td> <td>Â </td> </tr> <tr> <td>1</td> <td>position (y-axis)</td> <td>-10</td> <td>10</td> <td>decimeters</td> <td>Â </td> </tr> <tr> <td>2</td> <td>angle vs horizon</td> <td>-6</td> <td>6</td> <td>radians</td> <td>Â </td> </tr> <tr> <td>3</td> <td>velocity (x-axis)</td> <td>-20</td> <td>60</td> <td>?</td> <td>Â </td> </tr> <tr> <td>4</td> <td>velocity (y-axis)</td> <td>-25</td> <td>60</td> <td>?</td> <td>Â </td> </tr> </tbody> </table> <p>This makes total of <code class="language-plaintext highlighter-rouge">60</code> floats for the body state, which are normalized and then returned as the <code class="language-plaintext highlighter-rouge">obs</code> (an <code class="language-plaintext highlighter-rouge">np.ndarray((60,), dtype=np.float32)</code>) element of the envâ€™s <code class="language-plaintext highlighter-rouge">step</code> return values.</p> <h5 id="-rewards">ğŸ© Rewards</h5> <p>The reward on each step is equal to:</p> \[R = C_s\frac{\Delta_s}{\Delta_t} - \frac{C_t}{C_f}\Delta_t\] <p>where:</p> <ul> <li> <strong>R</strong> is the reward</li> <li> <strong>Î”<sub>s</sub></strong> is the change in distance ran since last step</li> <li> <strong>Î”<sub>t</sub></strong> is the change in time elapsed since last step</li> <li> <strong>C<sub>s</sub></strong> is a constant (configurable via <code class="language-plaintext highlighter-rouge">speed_rew_mult</code>)</li> <li> <strong>C<sub>t</sub></strong> is a constant (configurable via <code class="language-plaintext highlighter-rouge">time_cost_mult</code>)</li> <li> <strong>C<sub>f</sub></strong> is a constant (configurable via <code class="language-plaintext highlighter-rouge">frames_per_step</code>)</li> </ul> <h5 id="-termination">ğŸ’€ Termination</h5> <p>The env will terminate whenever the athlete:</p> <ul> <li> <em>steps</em> or <em>falls</em> beyond the 100-meter mark (considered a success)</li> <li>reaches the 105-meter mark (considered a success) *</li> <li>falls anywhere else (considered a failure)</li> <li>reaches the -10-meter mark (considered a failure)</li> </ul> <p>* In rare cases, the athlete goes past the finish line without the game detecting ground contact due to a bug, so a 105m end-game condition was added.</p> <h5 id="-ï¸-rendering"> <a id="rendering"></a> ğŸ–¼ï¸ Rendering</h5> <p>The env supports two render modes: <code class="language-plaintext highlighter-rouge">browser</code> and <code class="language-plaintext highlighter-rouge">rgb_array</code>. In both cases, a call to <code class="language-plaintext highlighter-rouge">.render()</code> will render a frame in the browser, but with <code class="language-plaintext highlighter-rouge">rgb_array</code> the frame itself is also returned as an image. This is needed when a human is playing, as this image is re-rendered in a pygame window which also receives the keyboard input. As this would result in frames being visualized twice (in both the browser and the pygame window), the configuration parameter <code class="language-plaintext highlighter-rouge">game_in_browser</code> is used to hide the browser part.</p> <div class="row justify-content-md-center"> <div class="col-sm"> <figure> <picture> <img src="/assets/img/qwop-gym/play.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm"> <figure> <picture> <img src="/assets/img/qwop-gym/replay.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> <div class="col-sm"> <figure> <picture> <img src="/assets/img/qwop-gym/train.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="row justify-content-md-center"> <div class="col-sm-8"> <figure> <picture> <img src="/assets/img/qwop-gym/demo-2.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="AI playing VCMI" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> An AI playing QWOP with realtime debug data rendering </div> <h5 id="ï¸-resetting">â™»ï¸ Resetting</h5> <p>This env supports two reset modes: <em>soft</em> and <em>hard</em>.</p> <p>In both cases, QwopEnv instance variables are reset and the difference lies in how QWOP reset is performed.</p> <p><strong>Soft</strong> resets instruct the game engine to start a new game. Repeating the exact same actions after a soft reset <em>may</em> result in a different outcome.</p> <p><strong>Soft</strong> resets are lightweight, fast and unobtrusive. They are enabled by default.</p> <p>For most intents and purposes, soft resets should be enough, as they provide a <em>nearly</em> deterministic env - a state-action will yield a predictable next state in ~99.99% of the times (empirically measured).</p> <p><strong>Hard</strong> resets will re-load the web page (QWOP.html) ie. the entire game engine is re-initialized. Repeating the exact same actions after a hard reset <em>will</em> result in the exact same outcome.</p> <p><strong>Hard</strong> resets are cumbersome and more obtrusive (each page reload causes a visible flicker). To enable it, pass the <code class="language-plaintext highlighter-rouge">reload_on_reset=True</code> keyword argument to the QwopEnv constructor.</p> <p>With this reset mode, the environment becomes fully deterministic, given the step number is part of the state: an action <code class="language-plaintext highlighter-rouge">a</code> at state <code class="language-plaintext highlighter-rouge">s</code> will always yield exactly one specific state <code class="language-plaintext highlighter-rouge">s+1</code>.</p> <h5 id="configuration-parameters">Configuration parameters</h5> <p>A list of all aspects of the game I have made configurable:</p> <table> <thead> <tr> <th>name</th> <th>type</th> <th>default</th> <th>description</th> <th>Â </th> <th>Â </th> <th>Â </th> </tr> </thead> <tbody> <tr> <td><code class="language-plaintext highlighter-rouge">browser</code></td> <td>string</td> <td>Path to the web browser binary</td> <td>Â </td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">driver</code></td> <td>string</td> <td>Â </td> <td>Path to the chromedriver binary</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">render_mode</code></td> <td>string</td> <td>Â </td> <td>Supported render modes (either <code class="language-plaintext highlighter-rouge">browser</code> or <code class="language-plaintext highlighter-rouge">rgb_array</code>)</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">failure_cost</code></td> <td>number</td> <td><code class="language-plaintext highlighter-rouge">10</code></td> <td>Subtracted from the reward at the end of unsuccessful episodes</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">success_reward</code></td> <td>number</td> <td><code class="language-plaintext highlighter-rouge">50</code></td> <td>Added to the reward at the end of successful episodes</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">time_cost_mult</code></td> <td>number</td> <td><code class="language-plaintext highlighter-rouge">10</code></td> <td>Multiplier for the amount subtracted from the reward at each step</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">frames_per_step</code></td> <td>int</td> <td><code class="language-plaintext highlighter-rouge">1</code></td> <td>Number of frames to advance per call to <code class="language-plaintext highlighter-rouge">.step</code> (aka. <em>frameskip</em>)</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">stat_in_browser</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">False</code></td> <td>Display various game stats in the browser next to the game area</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">game_in_browser</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">True</code></td> <td>Display the game area itself in the browser</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">text_in_browser</code></td> <td>string</td> <td>Â </td> <td>Display a static text next to the game area in the browser</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">reload_on_reset</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">False</code></td> <td>Perform a page reload on each call to <code class="language-plaintext highlighter-rouge">.reset</code> (aka. â€œhard resetâ€)</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">auto_draw</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">False</code></td> <td>Automatically draw the current frame on each call to <code class="language-plaintext highlighter-rouge">.reset</code> </td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">reduced_action_set</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">False</code></td> <td>Reduce possible actions from 16 to just 9</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">t_for_terminate</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">False</code></td> <td>Map an additional action to the T key for terminating the env</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">loglevel</code></td> <td>string</td> <td><code class="language-plaintext highlighter-rouge">WARN</code></td> <td>Logger level (DEBUG</td> <td>INFO</td> <td>WARN</td> <td>ERROR)</td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">seed</code></td> <td>int</td> <td>Â </td> <td>Seed (must be between 0 and 2^31), auto-generated if blank</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> <tr> <td><code class="language-plaintext highlighter-rouge">browser_mock</code></td> <td>bool</td> <td><code class="language-plaintext highlighter-rouge">False</code></td> <td>Used for debugging when no browser is needed</td> <td>Â </td> <td>Â </td> <td>Â </td> </tr> </tbody> </table> <h3 id="results">Results</h3> <p>I used different RL algorithms to train AI agents with varying levels of success. BC (Behavioural Cloning), PPO (Proximal Policy Optimization), DQN (Deep Q-Network), QR-DQN (Quantile Regression DQN) are among some of the popular RL algorithms I used throughought this experiment.</p> <div class="row justify-content-md-center"> <div class="col-sm-8"> <figure> <picture> <img src="/assets/img/qwop-gym/demo.gif" class="img-fluid rounded z-depth-1" width="100%" height="auto" data-zoomable="" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Several AI agents playing QWOP, but trained with different RL algorithms </div> <p>The QRDQN agent performed best and topped at 5.3s game-time after several hours of training, which would place it on 5th place on the <a href="https://www.speedrun.com/qwop" rel="external nofollow noopener" target="_blank">QWOP leaderboard</a>.</p> <p>I have prepared a video which showcases the results of the qwop-gym experiment:</p> <div class="row justify-content-md-center"> <div class="col-sm-8"> <iframe width="560" height="315" src="https://www.youtube.com/embed/2qNKjRwcx74?si=cJxVNfl_rh0ly-8x" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture; web-share" referrerpolicy="strict-origin-when-cross-origin" allowfullscreen=""></iframe> </div> </div> <h3 id="conclusion">Conclusion</h3> <p>The AI showed a remarkable performance and was able to reach the finish line in 5.3 seconds, ranking among the top 5 best players in the world.</p> <p>Although part of the objective (to outperform the world champion) was not met, I felt confident that it was just a matter of time until that happened given more time and effort were to be invested. The journey was very educational and armed me with confidence, experience and knowledge which I was eager to immediately put to work in new, more sophisticated RL projects instead.</p> </article> </div> </div> <footer class="sticky-bottom mt-5"> <div class="container"> Â© Copyright 2025 Simeon Manolov. <br>Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> and <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a>. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@4/imagesloaded.pkgd.min.js"></script> <script defer src="/assets/js/masonry.js" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.8/dist/medium-zoom.min.js" integrity="sha256-7PhEpEWEW0XXQ0k6kQrPKwuoIomz8R8IYyuU1Qew4P8=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?939a575388f286729c0279bcadb1d6f8"></script> <script defer src="https://unpkg.com/bootstrap-table@1.22.1/dist/bootstrap-table.min.js"></script> <script src="/assets/js/no_defer.js?2930004b8d7fcd0a8e00fdcfc8fc9f24"></script> <script defer src="/assets/js/common.js?4a129fbf39254905f505c7246e641eaf"></script> <script defer src="/assets/js/copy_code.js?7254ae07fe9cc5f3a10843e1c0817c9c" type="text/javascript"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script type="text/javascript">window.MathJax={tex:{tags:"ams"}};</script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script> <script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript">function progressBarSetup(){"max"in document.createElement("progress")?(initializeProgressElement(),$(document).on("scroll",function(){progressBar.attr({value:getCurrentScrollPosition()})}),$(window).on("resize",initializeProgressElement)):(resizeProgressBar(),$(document).on("scroll",resizeProgressBar),$(window).on("resize",resizeProgressBar))}function getCurrentScrollPosition(){return $(window).scrollTop()}function initializeProgressElement(){let e=$("#navbar").outerHeight(!0);$("body").css({"padding-top":e}),$("progress-container").css({"padding-top":e}),progressBar.css({top:e}),progressBar.attr({max:getDistanceToScroll(),value:getCurrentScrollPosition()})}function getDistanceToScroll(){return $(document).height()-$(window).height()}function resizeProgressBar(){progressBar.css({width:getWidthPercentage()+"%"})}function getWidthPercentage(){return getCurrentScrollPosition()/getDistanceToScroll()*100}const progressBar=$("#progress");window.onload=function(){setTimeout(progressBarSetup,50)};</script> </body> </html>